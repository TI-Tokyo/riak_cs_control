#!/bin/bash

. {{platform_etc_dir}}/config
export CS_HOST CS_PORT CS_PROTO CS_CONTROL_PORT CS_ADMIN_KEY CS_ADMIN_SECRET LOG_DIR LOG_LEVEL

RUNNER_GEN_DIR={{platform_gen_dir}}
RELX_RIAK={{platform_bin_dir}}/riak-cs-control
export PID_DIR={{pid_dir}}
export USE_NODETOOL=1  # {use_nodetool, true} is not clear enough

PID_FILE=$PID_DIR/riak-cs-control

mkdir -p $PID_DIR

case "$1" in
    stop)
        maybe_su $RELX_RIAK $* \
	    && rm -f $PID_DIR/riak-cs-control.pid
	;;
    *)
        maybe_su $RELX_RIAK $*
        ;;
esac
